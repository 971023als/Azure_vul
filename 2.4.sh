#!/bin/bash

# 변수 초기화
분류="권한 관리"
코드="2.4"
위험도="중요도 상"
진단_항목="인스턴스 서비스 액세스 정책 관리"
대응방안='{
  "설명": "Azure RBAC(Azure 역할 기반 액세스 제어)를 사용하면 팀 내에서 업무를 분리하고 인스턴스 서비스(가상 머신, Container Instances, Kubernetes Services 등)에서 사용자에게 해당 작업을 수행하는 데 필요한 만큼의 권한만 부여할 수 있습니다.",
  "설정방법": [
    "인스턴스 서비스(가상머신) 목록 확인",
    "인스턴스 내 IAM 역할 할당 추가",
    "서비스 목적에 맞는 역할 할당 추가",
    "역할 할당 구성원 추가",
    "역할 할당 검토",
    "역할 할당 추가 완료 및 확인"
  ]
}'
현황=()
진단_결과=""

# 인스턴스 서비스 액세스 정책 진단
echo "진단 시작..."
# 여기서는 실제 Azure CLI 명령어로 진단을 진행해야 합니다. 예를 들어:
# az vm list --query "[].{id:id, name:name, location:location}" --output json

# 임시 진단 결과 할당
진단_결과="양호" # 또는 "취약"을 할당할 수 있습니다.

# 결과 JSON 출력
echo "{
  \"분류\": \"$분류\",
  \"코드\": \"$코드\",
  \"위험도\": \"$위험도\",
  \"진단_항목\": \"$진단_항목\",
  \"대응방안\": $대응방안,
  \"현황\": $현황,
  \"진단_결과\": \"$진단_결과\"
}"
